import{a as h,t as _,b as S}from"../chunks/IJMoEVRx.js";import{p as J,c as C,s as o,r as b,t as ne,b as X,g as s,d as A,a as B,e as re,f as se,n as k,T as Pe}from"../chunks/DVmdCokJ.js";import{d as we,s as ve,p as G}from"../chunks/D1rJHNN0.js";import{i as ge}from"../chunks/CJVv8vLi.js";import{e as ue,i as he}from"../chunks/Dp8kRQl_.js";import{b as oe}from"../chunks/B5Nunh1s.js";import{o as fe,a as ye}from"../chunks/nV-4aG2w.js";import{s as be}from"../chunks/DOQqt08K.js";import{s as Ae}from"../chunks/DLg2SwNZ.js";import{I as _e,a as Se}from"../chunks/CDgYgN1L.js";import{H as Te}from"../chunks/C2YnBynH.js";import"../chunks/D0xhmZqL.js";import{i as Le}from"../chunks/nyYEL0NA.js";import{A as R}from"../chunks/Gc-VDlzX.js";import{L as I}from"../chunks/BDMEyPIU.js";import{c as Me,C as U,B as Ee,s as De}from"../chunks/CVbmncBi.js";import{H as $e}from"../chunks/CqbZHWF5.js";import{L as ce}from"../chunks/W9vy9Tiv.js";import{C as He}from"../chunks/CQecHAK4.js";const ae=(t,r,e,i)=>{for(;r<t.a.length&&e<t.b.length;){const n=t.a.codePointAt(r),u=t.b.codePointAt(e);if(n!==u)break;const f=1+ +(n>65535);r+=f,e+=f}if(r>=t.a.length&&e>=t.b.length)return t.reducedMaxCost=i,i;let a=null;if(t.allowReplacement&&r<t.a.length&&e<t.b.length){const n=i+t.replacementCost;n<t.reducedMaxCost&&n<=t.maxCost&&(a=ae(t,r+1+ +(t.a.codePointAt(r)>65535),e+1+ +(t.b.codePointAt(e)>65535),n))}if(t.allowInsertion&&e<t.b.length){const n=i+t.insertionCost;if(n<t.reducedMaxCost&&n<=t.maxCost){const u=ae(t,r,e+1+ +(t.b.codePointAt(e)>65535),n);(a===null||u!==null&&u<a)&&(a=u)}}if(t.allowDeletion&&r<t.a.length){const n=i+t.deletionCost;if(n<t.reducedMaxCost&&n<=t.maxCost){const u=ae(t,r+1+ +(t.a.codePointAt(r)>65535),e,n);(a===null||u!==null&&u<a)&&(a=u)}}return a},te=t=>t===void 0?!0:isFinite(t)?t>=0:!1,Ie=(t,r,e)=>{if(!te(e==null?void 0:e.maxCost))throw new Error(`Invalid value for maxCost: ${e.maxCost}`);if(!te(e==null?void 0:e.insertionCost))throw new Error(`Invalid value for insertionCost: ${e.insertionCost}`);if(!te(e==null?void 0:e.deletionCost))throw new Error(`Invalid value for deletionCost: ${e.deletionCost}`);if(!te(e==null?void 0:e.replacementCost))throw new Error(`Invalid value for replacementCost: ${e.replacementCost}`);return ae({a:t,b:r,maxCost:e.maxCost,reducedMaxCost:1/0,allowInsertion:e.allowInsertion??!0,insertionCost:e.insertionCost??1,allowDeletion:e.allowDeletion??!0,deletionCost:e.deletionCost??1,allowReplacement:e.allowReplacement??!0,replacementCost:e.replacementCost??1},0,0,0)},Ce=t=>{let r="";for(const e of t){const i=e.charCodeAt(0);i>=97&&i<=122?r+=String.fromCharCode(i-32):i>=65&&i<=90&&(r+=e)}return r},xe=(t,r)=>{const e=Ce(t),i=[];for(let a=0;a<r.length;++a){let n=null;r[a].index.indexOf(e)!==-1?n=(r[a].index.length-e.length)*.01:n=Ie(e,r[a].index,{maxCost:Math.min(Math.floor(r[a].index.length/2),2),insertionCost:.1}),n!==null&&i.push([a,n])}return i.sort((a,n)=>a[1]-n[1]).map(a=>a[0])},Be=async()=>{let t;const r=new Promise(i=>{t=i}),e=new Image;return e.onload=()=>{t!==void 0&&t(e)},e.onerror=()=>{t!==void 0&&t("error")},e.src="https://aaronstanek.com/static-web-content/ping-latency-map/base-map-simplified.svg",r},je=async()=>{const t=await fetch("https://aaronstanek.com/static-web-content/ping-latency-map/pings.data");if(t.status<200||t.status>299)return"error";const r=new Uint8Array(await(await t.blob()).arrayBuffer()),e=[[]];let i=0;for(let a=1;;++a){if(i>=r.length)return e;const n=[];e.push(n);for(let u=0;u<a;++u){if(i>=r.length)return e;const f=r[i++];f===255?n.push(null):n.push(((f&31)<<(f>>5))/2)}}},Re=async()=>{const t=await fetch("https://aaronstanek.com/static-web-content/ping-latency-map/servers.json");if(t.status<200||t.status>299)return"error";const r=await t.json();if(!Array.isArray(r))return"error";const e=[];for(const i of r){if(!Array.isArray(i))return"error";const a=i[0],n=i[1],u=i[2],f=i[3];if(typeof a!="string"||typeof n!="string"||typeof u!="number"||typeof f!="number")return"error";e.push({city:a,country:n,index:Ce(`${a}${n}`),x:u,y:f})}return e};var Ge=_('<div class="flex flex-row"><div class="flex flex-row items-center"><button class="highlightonhover"><div style="padding: 4px"><img src="https://aaronstanek.com/static-web-content/x.svg" width="12px" height="12px" alt="Remove source city"></div></button> <div class="w-2"></div> <div class="flex-10" style="padding:3px"> </div></div></div>');function Ue(t,r){J(r,!0);var e=Ge(),i=C(e),a=C(i);a.__click=function(...f){var m;(m=r.removeThisServer)==null||m.apply(this,f)};var n=o(a,4),u=C(n,!0);b(n),b(i),b(e),ne(()=>{var f,m,T,w;be(a,"aria-label",`Remove Source City: ${(f=r.server)==null?void 0:f.city}, ${(m=r.server)==null?void 0:m.country}`),ve(u,`${(T=r.server)==null?void 0:T.city}, ${(w=r.server)==null?void 0:w.country}`)}),h(t,e),X()}we(["click"]);var Ne=_("<span><!></span>");function Oe(t,r){J(r,!0);let e=B(void 0),i=u=>{if(s(e)===void 0){r.callback();return}const f=s(e).getBoundingClientRect();(u.pageX<f.left||u.pageX>f.right||u.pageY<f.top||u.pageY>f.bottom)&&r.callback()};fe(()=>{addEventListener("click",i)}),ye(()=>{removeEventListener("click",i)});var a=Ne(),n=C(a);Ae(n,()=>r.children),b(a),oe(a,u=>A(e,u),()=>s(e)),h(t,a),X()}var Fe=(t,r,e,i)=>{r(),e.selectCallback(s(i))},Ve=_('<button aria-label="Accept new source city suggestion" class="highlightonhover"> </button>'),We=_('<div style="position:relative"><!> <div class="flex flex-col floaty svelte-20goaj"></div></div>');function ze(t,r){J(r,!0);let e=B(""),i=re(()=>r.serverList===void 0||r.serverList==="error"||s(e).length===0?[]:xe(s(e),r.serverList).filter(r.serverFilter).slice(0,5));const a=()=>{var m;(m=s(n))==null||m.writeValue("")};let n=B(void 0),u=B(void 0),f;fe(()=>{f=m=>{if(s(e).length===0||s(n)===void 0||s(u)===void 0)return;const T=m.key==="ArrowUp"?"up":m.key==="ArrowDown"?"down":"none";if(T==="none")return;const w=Array.from(s(u).children).filter(p=>p instanceof HTMLElement);if(w.length===0)return;const D=document.activeElement??s(n).rawHtmlElement();if(D.contains(s(n).rawHtmlElement())){m.preventDefault(),T==="down"?w[0].focus():w[w.length-1].focus();return}for(let p=0;p<w.length;++p)if(D.contains(w[p])){m.preventDefault(),T==="down"?p===w.length-1?s(n).rawHtmlElement().focus():w[p+1].focus():p===0?s(n).rawHtmlElement().focus():w[p-1].focus();return}},addEventListener("keydown",f)}),ye(()=>{f&&removeEventListener("keydown",f)}),Oe(t,{callback:a,children:(m,T)=>{var w=We(),D=C(w);oe(_e(D,{ariaLabel:"Search for a city to add as a source city.",width:290,parser:L=>{A(e,G(L))}}),L=>A(n,G(L)),()=>s(n));var p=o(D,2);ue(p,21,()=>s(i),he,(L,x)=>{var M=Ve();M.__click=[Fe,a,r,x];var j=C(M,!0);b(M),ne(()=>ve(j,r.serverList===void 0||r.serverList==="error"?"undefined":`${r.serverList[s(x)].city}, ${r.serverList[s(x)].country}`)),h(L,M)}),b(p),oe(p,L=>A(u,L),()=>s(u)),b(w),ne(()=>be(p,"style",s(i).length>0?"":"display: none")),h(m,w)},$$slots:{default:!0}}),X()}we(["click"]);const Ye=(t,r)=>t.server.country!==r.server.country?t.server.country<r.server.country?-1:1:t.server.city!==r.server.city?t.server.city<r.server.city?-1:1:t.id-r.id,qe=t=>{const r=[];for(let e=0;e<t.length;e++)r.push({id:e,server:t[e]});return r.sort(Ye),r};var Je=_("<h2>About this App</h2>"),Xe=_('<h3 class="mt-6">Table of Contents</h3>'),Qe=_('<h3 class="mt-6">Understanding Ping Latency</h3>'),Ke=_('<h3 class="mt-6 mb-6">The Impact of Latency on User Experience</h3>'),Ze=_('<h3 class="mt-6">Disclaimer</h3>'),et=_('<h3 class="mt-6">Credits</h3>'),tt=_('<h3 class="mt-6">Source Code</h3>'),rt=_('<h3 class="mt-6 mb-6">Bibliography</h3>'),st=_(`<!> <!> <div class="mt-1">1. <!><br> 2. <!><br> 3. <!><br> 4. <!><br> 5. <!><br> 6. <!><br> 7. <!><br> 8. <!></div> <!> <div class="mt-6">Ping latency measures the time it takes to send a piece of information to a computer on the
	internet and to receive a response back from that computer.</div> <div class="mt-6">Ping latency is roughly correlated with the physical distance between the sender and receiver of
	the ping. As a sense of scale, ping latency is usually measured in milliseconds (ms). A ping
	between two computers in the same metro area takes about 1ms. A ping between two computers in the
	same part of a continent typically takes about 20ms; for example, between New York and Chicago, or
	between London and Berlin. A ping between computers on opposite sides of the planet takes about
	300ms.<!></div> <!> <div class="mt-6">High ping latency translates to slow-loading websites and sluggish responses. This directly
	affects user satisfaction. Even slight increases in ping latency can significantly hurt website
	performance. The probability of a bounce increases 32% as page load time goes from 1 second to 3
	seconds.<!> 53% of visits are abandoned if a mobile site takes longer
	than 3 seconds to load.<!></div> <div class="mt-6">So, how much ping latency is acceptable for a modern website? There is no solid number, but
	generally aiming for a 50ms ping latency between a user's city and a webserver's city is a good
	benchmark. Taking this 50ms and adding another 50ms for the user's device to route through the
	local ISP and for the webserver to process the request gives a 100ms delay overall between the
	time a user clicks a button, and the time that the webpage responds.<!> 100ms is the longest that a computer can take to respond where the user perceives the response to
	be instantaneous.<!></div> <!> <div class="mt-6">This map is intended only as an approximate reference. The information on the map including, but
	not limited to, the ping latencies between specific cities, the locations of cities, and the
	locations of national borders may differ from the real world.</div> <!> <div class="mt-6">The map data<!> for this project is used under license from Wikimedia.</div> <div class="mt-6">The ping data<!> for this project is used under license
	from WonderNetwork.</div> <!> <div class="mt-6">The source code for this project is <!>.</div> <!> <!>`,1);function at(t,r){J(r,!1);const e=Me({baseMap:{title:"Mercator Projection.svg",accessed:"30 Apr 2024",author:"Bosanko, Geordie",url:"https://commons.wikimedia.org/wiki/File:Mercator_Projection.svg"},aDayInTheLifeOfTheInternet:{title:"A day in the life of the Internet",accessed:"30 Apr 2024",author:"Reinheimer, Paul",url:"https://wonderproxy.com/blog/a-day-in-the-life-of-the-internet/"},wondernetworkPings:{title:"Global Ping Statistics",accessed:"30 Apr 2024",author:"WonderNetwork",url:"https://wondernetwork.com/pings"},"1to3Seconds":{title:"Page load time statistics",accessed:"14 Aug 2024",author:"Google",url:"https://www.thinkwithgoogle.com/marketing-strategies/app-and-mobile/page-load-time-statistics/"},abandonAt3Seconds:{title:"Mobile site load time statistics",accessed:"14 Aug 2024",author:"Google",url:"https://www.thinkwithgoogle.com/consumer-insights/consumer-trends/mobile-site-load-time-statistics/"},ultimateInfographic:{title:"The ultimate mobile page speed infographic",accessed:"14 Aug 2024",author:"Google",url:"https://blog.google/products/adsense/the-ultimate-mobile-page-speed-infographic/"},isMyConnectionGood:{title:"What Are Good Latency & Ping Speeds?",accessed:"14 Aug 2024",author:"Pingman Tools",url:"https://www.pingplotter.com/wisdom/article/is-my-connection-good/"},nielsen:{title:"Response Times: The 3 Important Limits",accessed:"14 Aug 2024",author:"Nielsen, Jakob",url:"https://www.nngroup.com/articles/response-times-3-important-limits/"}});Le();var i=st(),a=se(i);$e(a,{children:(d,y)=>{var c=Je();h(d,c)},$$slots:{default:!0}});var n=o(a,2);R(n,{name:"contents",children:(d,y)=>{var c=Xe();h(d,c)},$$slots:{default:!0}});var u=o(n,2),f=o(C(u));I(f,{href:"#how-to",children:(d,y)=>{k();var c=S("How to Use This Tool");h(d,c)},$$slots:{default:!0}});var m=o(f,3);I(m,{href:"#map",children:(d,y)=>{k();var c=S("The Map");h(d,c)},$$slots:{default:!0}});var T=o(m,3);I(T,{href:"#understanding",children:(d,y)=>{k();var c=S("Understanding Ping Latency");h(d,c)},$$slots:{default:!0}});var w=o(T,3);I(w,{href:"#impact",children:(d,y)=>{k();var c=S("The Impact of Latency on User Experience");h(d,c)},$$slots:{default:!0}});var D=o(w,3);I(D,{href:"#disclaimer",children:(d,y)=>{k();var c=S("Disclaimer");h(d,c)},$$slots:{default:!0}});var p=o(D,3);I(p,{href:"#credits",children:(d,y)=>{k();var c=S("Credits");h(d,c)},$$slots:{default:!0}});var L=o(p,3);I(L,{href:"#source-code",children:(d,y)=>{k();var c=S("Source Code");h(d,c)},$$slots:{default:!0}});var x=o(L,3);I(x,{href:"#bibliography",children:(d,y)=>{k();var c=S("Bibliography");h(d,c)},$$slots:{default:!0}}),b(u);var M=o(u,2);R(M,{name:"understanding",children:(d,y)=>{var c=Qe();h(d,c)},$$slots:{default:!0}});var j=o(M,4),Q=o(C(j));U(Q,{get ref(){return e.get.wondernetworkPings}}),b(j);var V=o(j,2);R(V,{name:"impact",children:(d,y)=>{var c=Ke();h(d,c)},$$slots:{default:!0}});var N=o(V,2),O=o(C(N));U(O,{get ref(){return e.get["1to3Seconds"]}});var ie=o(O,2);const K=Pe(()=>[e.get.abandonAt3Seconds,e.get.ultimateInfographic]);U(ie,{get ref(){return s(K)}}),b(N);var F=o(N,2),W=o(C(F));U(W,{get ref(){return e.get.isMyConnectionGood}});var le=o(W,2);U(le,{get ref(){return e.get.nielsen}}),b(F);var z=o(F,2);R(z,{name:"disclaimer",children:(d,y)=>{var c=Ze();h(d,c)},$$slots:{default:!0}});var Z=o(z,4);R(Z,{name:"credits",children:(d,y)=>{var c=et();h(d,c)},$$slots:{default:!0}});var Y=o(Z,2),de=o(C(Y));U(de,{get ref(){return e.get.baseMap}}),k(),b(Y);var l=o(Y,2),v=o(C(l));U(v,{get ref(){return e.get.aDayInTheLifeOfTheInternet}}),k(),b(l);var g=o(l,2);R(g,{name:"source-code",children:(d,y)=>{var c=tt();h(d,c)},$$slots:{default:!0}});var $=o(g,2),H=o(C($));I(H,{href:"https://github.com/aaronstanek/ping-latency-map",children:(d,y)=>{k();var c=S("available on GitHub");h(d,c)},$$slots:{default:!0}}),k(),b($);var P=o($,2);R(P,{name:"bibliography",children:(d,y)=>{var c=rt();h(d,c)},$$slots:{default:!0}});var E=o(P,2);Ee(E,{get highlightPipe(){return e.highlightPipe},get ordered(){return e.ordered}}),h(t,i),X()}var nt=_("<h2>The App</h2>"),ot=_(`<div class="mt-6 mb-6">The interactive map below shows ping latency between major cities worldwide. You can customize
		the map by selecting source cities and setting a ping latency threshold. If a city has a ping
		latency with any one of the source cities that is less than the ping latency threshold, then
		that city is marked in blue. Otherwise, if the ping latency between a city and all the source
		cities is greater than the threshold, the city is marked in red.</div>`),it=_('<canvas width="800px" height="525px" class="svelte-15ckied"></canvas>'),lt=_('<div class="flex flex-col serverlist svelte-15ckied"></div>'),dt=_('<br> <div class="flex flex-col items-center gap-2"><div>Ping latency threshold (in milliseconds)</div> <!></div> <br> <div class="flex flex-col items-center gap-2"><div>Add a source city by name</div> <!></div> <br> <div class="pb-0.5">Source cities</div> <!>',1),ct=_('<div class="flex gap-3" style="padding: 3px"><div> </div> <!></div>'),ut=_('<div class="flex flex-row"><div>Available cities</div> <div class="w-2"></div> <!></div> <div class="serverlist svelte-15ckied"></div>',1),ht=_('<!> <h1 class="text-center">Ping Latency Map</h1> <!> <div class="flex justify-center mt-3"><!></div> <!> <!> <!> <br> <!> <!>',1);function Et(t,r){J(r,!0);let e,i,a=B(void 0),n=B("loading");{const l=()=>{e==="error"||i==="error"||s(a)==="error"?A(n,"error"):e!==void 0&&i!==void 0&&s(a)!==void 0&&A(n,"done")};(async()=>(e=await Be(),l()))(),(async()=>(i=await je(),l()))(),(async()=>(A(a,G(await Re())),l()))()}const u=50;let f=B(u),m=B(G([]));const T=l=>!s(m).includes(l),w=l=>{s(m).includes(l)||(s(m).push(l),A(m,G(s(m))),M())},D=l=>{A(m,G(s(m).filter(v=>v!==l))),M()};let p=B(void 0);const L=(l,v,g)=>{if(v===g)return 0;const $=Math.min(v,g),H=Math.max(v,g),P=l[H];return P===void 0?null:P[$]??null};let x;const M=()=>{if(s(p)===void 0||e===void 0||e==="error"||i===void 0||i==="error"||s(a)===void 0||s(a)==="error")return;const l=s(p).getContext("2d");if(l!==null){if(x===void 0||x.width!==s(p).width||x.height!==s(p).height){x=document.createElement("canvas"),x.width=s(p).width,x.height=s(p).height;const v=x.getContext("2d");if(v===null)return;v.fillStyle="white",v.fillRect(0,0,x.width,x.height),v.drawImage(e,0,0,x.width,x.height*(611/525))}l.drawImage(x,0,0);for(let v=0;v<s(a).length;++v){const g=s(a)[v];let $=null;for(const H of s(m)){const P=L(i,v,H);($===null||P!==null&&P<$)&&($=P)}$===null||$>=s(f)?l.fillStyle="rgb(175 0 64)":l.fillStyle="rgb(0 75 219)",l.beginPath(),l.arc(g.x*(s(p).width/1652.47),g.y*(s(p).height*(611/525)/1220.638),3*(s(p).width/800),0,2*Math.PI),l.fill()}}};fe(async()=>{const l=Date.now();for(;s(n)!=="done";){if(s(n)==="error"||Date.now()-l>=60*1e3){alert("An error occurred while loading the page. Please reload.");return}await new Promise(g=>setTimeout(g,10))}const v=xe("Washington",s(a));v.length>0&&A(m,G([v[0]])),M()});let j=B(!1);var Q=ht(),V=se(Q);Te(V,{canonicalUrl:"https://aaronstanek.com/projects/ping-latency-map",title:"Ping Latency Map",description:"Visualize ping times around the world. Choose cities, set ping latency thresholds, and see which cities respond the fastest.",image:"https://aaronstanek.com/static-web-content/ping-latency-map/base-map-simplified.svg"});var N=o(V,4);$e(N,{children:(l,v)=>{var g=nt();h(l,g)},$$slots:{default:!0}});var O=o(N,2),ie=C(O);I(ie,{href:"#contents",children:(l,v)=>{k();var g=S("Jump to Table of Contents");h(l,g)},$$slots:{default:!0}}),b(O);var K=o(O,2);R(K,{name:"how-to",children:(l,v)=>{var g=ot();h(l,g)},$$slots:{default:!0}});var F=o(K,2);R(F,{name:"map",children:(l,v)=>{var g=it();oe(g,$=>A(p,$),()=>s(p)),h(l,g)},$$slots:{default:!0}});var W=o(F,2);{var le=l=>{var v=dt(),g=o(se(v),2),$=o(C(g),2);const H=re(()=>Se(c=>{A(f,G(c)),M()})),P=re(()=>u.toString());_e($,{ariaLabel:"Set the ping latency threshold",width:75,get parser(){return s(H)},get initialValue(){return s(P)}}),b(g);var E=o(g,4),d=o(C(E),2);ze(d,{serverFilter:T,selectCallback:w,get serverList(){return s(a)}}),b(E);var y=o(E,6);He(y,{children:(c,me)=>{var q=lt();ue(q,21,()=>s(m),he,(pe,ee)=>{const ke=re(()=>s(a)===void 0||s(a)==="error"?void 0:s(a)[s(ee)]);Ue(pe,{get server(){return s(ke)},removeThisServer:()=>D(s(ee))})}),b(q),h(c,q)},$$slots:{default:!0}}),h(l,v)};ge(W,l=>{s(n)==="done"&&l(le)})}var z=o(W,4);{var Z=l=>{ce(l,{callback:()=>{A(j,!0)},children:(v,g)=>{k();var $=S("See available cities");h(v,$)},$$slots:{default:!0}})},Y=l=>{var v=ut(),g=se(v),$=o(C(g),4);ce($,{callback:()=>{A(j,!1)},children:(P,E)=>{k();var d=S("Hide");h(P,d)},$$slots:{default:!0}}),b(g);var H=o(g,2);ue(H,21,()=>s(a)===void 0||s(a)==="error"?[]:qe(s(a)),he,(P,E)=>{var d=ct(),y=C(d),c=C(y,!0);b(y);var me=o(y,2);ce(me,{callback:()=>{w(s(E).id),De("map")},children:(q,pe)=>{k();var ee=S("add");h(q,ee)},$$slots:{default:!0}}),b(d),ne(()=>ve(c,`${s(E).server.city}, ${s(E).server.country}`)),h(P,d)}),b(H),h(l,v)};ge(z,l=>{s(j)?l(Y,!1):l(Z)})}var de=o(z,2);at(de,{}),h(t,Q),X()}export{Et as component};
